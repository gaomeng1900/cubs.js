var m=Object.defineProperty;var D=(s,t,n)=>t in s?m(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var E=(s,t,n)=>(D(s,typeof t!="symbol"?t+"":t,n),n);import{E as g,R as k,r as M,b as f,a as b,P as R,T as A,p as B,c as T}from"./Test.module-3cb5013e.js";class F extends g{constructor(){super();E(this,"xStart",0);E(this,"xEnd",100);E(this,"yStart",0);E(this,"yEnd",100);E(this,"viewportX",100);E(this,"viewportY",100);E(this,"viewportWidth",400);E(this,"viewportHeight",200);E(this,"indicator",new k);this.indicator.style.stroke=!0,this.indicator.style.fill=!1,this.indicator.style.pointerEvents="none",this.indicator.style.strokeStyle=M(.5),this.indicator.addEventListener("beforeRender",n=>{this.indicator.x=this.viewportX,this.indicator.y=this.viewportY,this.indicator.width=this.viewportWidth,this.indicator.height=this.viewportHeight})}get top(){return this.viewportY}get bottom(){return this.viewportY+this.viewportHeight}get left(){return this.viewportX}get right(){return this.viewportX+this.viewportWidth}project(n,p){const y=(n-this.xStart)/(this.xEnd-this.xStart),h=(p-this.yStart)/(this.yEnd-this.yStart),d=y*this.viewportWidth+this.viewportX,r=-h*this.viewportHeight+this.viewportY+this.viewportHeight;return[d,r]}unproject(n,p){const y=(n-this.viewportX)/this.viewportWidth,h=-(p-this.viewportY-this.viewportHeight)/this.viewportHeight,d=y*(this.xEnd-this.xStart)+this.xStart,r=h*(this.yEnd-this.yStart)+this.yStart;return[d,r]}}function O(s,t,n){const{lockX:p=!1,lockY:y=!1,lockScale:h=!1}=n||{},d=(n==null?void 0:n.xStartMin)??-1/0,r=(n==null?void 0:n.xEndMax)??1/0,i=o=>{const l=o.srcEvent;if(l.button!==2)return;l.preventDefault(),s.cursor="grabbing";const{left:x,top:u}=s.canvas.getBoundingClientRect()||{left:0,top:0},c=l.clientX-x,w=l.clientY-u,S=t.xStart,v=t.xEnd,L=X=>{const Y=X.srcEvent,j=Y.clientX-x,C=Y.clientY-u,P=(t.xEnd-t.xStart)/t.viewportWidth,I=(t.yEnd-t.yStart)/t.viewportHeight;if(!p){const V=S-(j-c)*P,H=v-(j-c)*P;V<d?t.xStart=d:H>r?t.xEnd=r:(t.xStart=V,t.xEnd=H)}y||(t.yStart=t.yStart+(C-w)*I,t.yEnd=t.yEnd+(C-w)*I),t.dispatchEvent({type:"update"})},W=X=>{s.cursor="default",s.removeEventListener("pointermove",L),s.removeEventListener("pointerup",W)};s.addEventListener("pointermove",L),s.addEventListener("pointerup",W)},e=o=>{if(h||o.buttons!==0)return;o.preventDefault();const l=Math.pow(1.1,o.deltaY/50),{left:x,top:u}=s.canvas.getBoundingClientRect()||{left:0,top:0},c=o.clientX-x,w=o.clientY-u,[S,v]=t.unproject(c,w);p||(t.xStart=(t.xStart-S)*l+S,t.xEnd=(t.xEnd-S)*l+S,t.xStart=Math.max(t.xStart,(n==null?void 0:n.xStartMin)??-1/0),t.xEnd=Math.min(t.xEnd,(n==null?void 0:n.xEndMax)??1/0)),y||(t.yStart=(t.yStart-v)*l+v,t.yEnd=(t.yEnd-v)*l+v),t.dispatchEvent({type:"update"})},a=o=>{o.preventDefault()};return s.addEventListener("pointerdown",i),s.canvas.addEventListener("wheel",e),s.canvas.addEventListener("contextmenu",a),function(){s.removeEventListener("pointerdown",i),s.canvas.removeEventListener("wheel",e),s.canvas.removeEventListener("contextmenu",a)}}class U extends f{constructor(t,n){super(),this.coordinator=t,this.config=n;const p=(n==null?void 0:n.followOrigin)??!0,y=(n==null?void 0:n.arrow)??!0,h=((n==null?void 0:n.arrowExtend)??20)*(y?1:0),d=new b;this.add(d),d.style.strokeStyle="red",d.style.lineWidth=2,d.dx=100,d.dy=0;const r=new R;r.points=[{x:10,y:0},{x:0,y:-7},{x:0,y:7}],y&&this.add(r),r.style.fillStyle="red";const i=new b;this.add(i),i.style.strokeStyle="green",i.style.lineWidth=2,i.dx=0,i.dy=-100;const e=new R;e.points=[{x:0,y:-10},{x:7,y:0},{x:-7,y:0}],y&&this.add(e),e.style.fillStyle="green",this.addEventListener("beforeRender",a=>{const o=this.coordinator.viewportX+this.coordinator.viewportWidth,l=this.coordinator.viewportY,x=this.coordinator.viewportX,u=this.coordinator.viewportY+this.coordinator.viewportHeight,c=p?this.coordinator.project(0,0):[x,u];d.x=c[0],d.y=c[1],d.dx=o-d.x+h,r.x=o+h,r.y=c[1],i.x=c[0],i.y=c[1],i.dy=l-i.y-h,e.x=c[0],e.y=l-h})}}function q(s,t){const n=new f,{minDistance:p=100,xToString:y=r=>r.toFixed(2),yToString:h=r=>r.toFixed(2)}=t||{},d=()=>{if(n.removeAll(),!(t!=null&&t.disableX)){const r=new f,i=s.viewportWidth,e=s.xEnd-s.xStart,a=i/e,o=Math.pow(10,Math.floor(Math.log10(e/10)));let l=o,x=a*l;x<p&&(l=o*2),x=a*l,x<p&&(l=o*5),x=a*l,x<p&&(l=o*10),x=a*l;const u=Math.ceil(s.xStart/l)*l;for(let c=u;c<=s.xEnd;c+=l){const w=new b;w.style.strokeStyle=(t==null?void 0:t.xColor)??"red",w.style.lineWidth=2,w.dx=0,w.dy=10;const S=s.project(c,0);w.x=S[0],w.y=s.bottom,r.add(w);const v=new A;v.text=y(c),v.style.fillStyle=(t==null?void 0:t.xColor)??"red",v.style.textAlign="center",v.style.textBaseline="top",v.style.font="12px sans-serif",v.x=S[0],v.y=s.bottom+20,r.add(v)}n.add(r)}if(!(t!=null&&t.disableY)){const r=new f,i=s.viewportHeight,e=s.yEnd-s.yStart,a=i/e,o=Math.pow(10,Math.floor(Math.log10(e/10)));let l=o,x=a*l;x<p&&(l=o*2),x=a*l,x<p&&(l=o*5),x=a*l,x<p&&(l=o*10),x=a*l;const u=Math.ceil(s.yStart/l)*l;for(let c=u;c<=s.yEnd;c+=l){const w=new b;w.style.strokeStyle=(t==null?void 0:t.yColor)??"green",w.style.lineWidth=2,w.dx=-10,w.dy=0;const S=s.project(0,c);w.x=s.left,w.y=S[1],r.add(w);const v=new A;v.text=h(c),v.style.fillStyle=(t==null?void 0:t.yColor)??"green",v.style.textAlign="right",v.style.textBaseline="middle",v.style.font="12px sans-serif",v.x=s.left-15,v.y=S[1],r.add(v)}n.add(r)}};return d(),s.addEventListener("update",r=>{d()}),n}function J(s,t,n){const{color:p,size:y=10}=n||{},h=new f;return t.map(d=>{const r=d.color??p??M(),i=d.size??y,e=B();e.style.fillStyle=r,e.radius=i,e.addEventListener("beforeRender",a=>{const o=s.project(d.x,d.y);e.x=o[0],e.y=o[1]}),h.add(e)}),h}function K(s,t,n){const{color:p=M(),lineWidth:y=2}=n||{},h=new f,d=t.slice().sort((i,e)=>i.x-e.x),r=new T;return r.style.strokeStyle=p,r.style.lineWidth=y,d.map(i=>{const e=s.project(i.x,i.y);r.points.push({x:e[0],y:e[1]})}),h.addEventListener("beforeRender",i=>{r.points=[],d.map(e=>{const a=s.project(e.x,e.y);r.points.push({x:a[0],y:a[1]})})}),h.add(r),h.userData.polyline=r,h}function N(s,t,n){const{color:p=M(.5),barWidth:y=1}=n||{},h=new f,d=t.slice().sort((i,e)=>i.x-e.x),r=new WeakMap;return d.map(i=>{const e=new k;e.style.fillStyle=i.color??p,h.add(e),r.set(i,e)}),h.addEventListener("beforeRender",i=>{d.map(e=>{const a=r.get(e);if(!a)throw new Error("bar data not found");const[o,l]=s.project(e.x-y/2,0),[x,u]=s.project(e.x+y/2,e.y);a.x=o,a.y=u,a.width=x-o,a.height=l-u})}),h}function Q(s,t,n){const{barWidth:p=1}=n||{},y=new f,h=t.slice().sort((i,e)=>i.x-e.x),d=new WeakMap,r=new WeakMap;return h.map(i=>{const e=new k,a=new b;a.style.lineWidth=2,i.open>i.close?(e.style.fillStyle="green",a.style.strokeStyle="green"):(e.style.fillStyle="red",a.style.strokeStyle="red"),y.add(a),y.add(e),d.set(i,e),r.set(i,a)}),y.addEventListener("beforeRender",i=>{h.map(e=>{const a=d.get(e);if(!a)throw new Error("bar data not found");const o=r.get(e);if(!o)throw new Error("shadow data not found");const[l,x]=s.project(e.x-p/2,e.open>e.close?e.open:e.close),[u,c]=s.project(e.x+p/2,e.open>e.close?e.close:e.open);a.x=l,a.y=c,a.width=u-l,a.height=x-c;const w=s.project(e.x,e.high),S=s.project(e.x,e.low);o.x=w[0],o.y=w[1],o.dx=0,o.dy=S[1]-w[1]})}),y}export{F as C,U as a,N as b,O as c,Q as d,K as l,J as s,q as t};
