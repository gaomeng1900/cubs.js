import{r as I,j as g}from"./index-767ff75a.js";import{S as T,s as W,r as b}from"./Test.module-0a03da6d.js";import{C as Y,a as R,c as V,b as A,d as H,l as O}from"./coordinate-a91a122f.js";function q(){const u=I.useRef(null),i=800,l=700;return I.useEffect(()=>{const E=u.current,n=new T(E),e=new Y;e.viewportX=50,e.viewportY=50,e.viewportWidth=i-100,e.viewportHeight=l-100;const P=new R(e,{followOrigin:!1});return n.add(e.indicator),n.add(P),fetch("./test-stock-data.csv").then(d=>d.text()).then(d=>{const f=d.trim().split(`
`),y=f[0].split(","),o=f.slice(1).map((t,a)=>{const k=t.split(","),h={};for(let c=0;c<y.length;c++)h[y[c]]=k[c],h.index=a;return h});o.forEach(t=>{t.timestamp=new Date().setTime(Date.parse(t.Datetime))});const p=o.map(t=>t.index).reduce((t,a)=>Math.min(t,a),1/0),x=o.map(t=>t.index).reduce((t,a)=>Math.max(t,a),-1/0);console.log("minIndex, maxIndex",p,x),e.xStart=p,e.xEnd=x,V(n,e,{lockY:!0,lockScale:!1,xStartMin:p,xEndMax:x});const C=o.map(t=>parseInt(t.Volume)).reduce((t,a)=>Math.max(t,a),-1/0),D=t=>t/C*100;e.yStart=0,e.yEnd=300,e.dispatchEvent({type:"update"});const M=o.map(t=>({x:t.index,y:D(parseInt(t.Volume))})),S=A(e,M,{barWidth:.9,color:b(.9)});n.add(S);const r=o.map(t=>({x:t.index,y:parseFloat(t["Adj Close"])})),m=r.map(t=>t.y).reduce((t,a)=>Math.min(t,a),1/0),w=r.map(t=>t.y).reduce((t,a)=>Math.max(t,a),-1/0);console.log("minPrice, maxPrice",m,w);const s=t=>(t-m)/(w-m)*100+100,v=o.map(t=>({x:t.index,open:s(parseFloat(t.Open)),close:s(parseFloat(t.Close)),high:s(parseFloat(t.High)),low:s(parseFloat(t.Low))}));console.log("candleData",v);const j=H(e,v,{barWidth:.8});n.add(j),r.forEach(t=>{t.y=s(t.y)+50});const F=O(e,r,{color:b(.9),lineWidth:1});n.add(F)}),()=>{n.dispose()}},[]),g.jsx("div",{className:W.wrapper,children:g.jsx("canvas",{ref:u,width:i,height:l,style:{width:i,height:l,border:"rgb(255, 255, 255) 3px solid",boxShadow:"#00000076 0 0 10px 1px"}})})}export{q as default};
