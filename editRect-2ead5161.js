import{R as m,C as w,e as u}from"./Test.module-f3780946.js";import{f}from"./misc-39328f97.js";function p(t,o,y={}){const h=r=>{const d=r.srcEvent;if(r.target!==r.currentTarget||d.button!==0)return;const{left:l,top:v}=t.canvas.getBoundingClientRect()||{left:0,top:0},g=(d.clientX-l-t.translate.x)/t.scale,i=(d.clientY-v-t.translate.y)/t.scale,n=g,a=i,e=new m(0,0,0,0);e.x=n,e.y=a,e.width=0,e.height=0,Object.assign(e.styles,y),t.add(e);const b=c=>{const s=c.srcEvent,j=(s.clientX-l-t.translate.x)/t.scale,O=(s.clientY-v-t.translate.y)/t.scale;e.width=j-n,e.height=O-a},x=c=>{if(t.removeEventListener("pointermove",b),t.removeEventListener("pointerup",x),f(e),e.width===0||e.height===0){t.remove(e);return}o==null||o({type:"rectCreation",target:e,currentTarget:t})};t.addEventListener("pointermove",b),t.addEventListener("pointerup",x)};return t.addEventListener("pointerdown",h),function(){t.removeEventListener("pointerdown",h)}}function z(t,o,y,h=10,r={},d={},l={}){const v=Object.freeze({type:"rectEdit",target:t,currentTarget:t}),g=()=>{const s={type:"beforeRectEdit",target:t,currentTarget:t};f(t),o==null||o(s),y==null||y(v)},i=new w(0,0,h);i.fixedRadius=!0,Object.assign(i.styles,r),Object.assign(i.hoverStyles,d),Object.assign(i.activeStyles,l),u(i,s=>{t.x+=s.dx,t.y+=s.dy,t.width-=s.dx,t.height-=s.dy,s.x=0,s.y=0},g);const n=new w(t.width,0,h);n.fixedRadius=!0,n.styles.zIndex=t.styles.zIndex,Object.assign(n.styles,r),Object.assign(n.hoverStyles,d),Object.assign(n.activeStyles,l),u(n,s=>{t.width+=s.dx,t.height-=s.dy,t.y+=s.dy,s.y=0},g);const a=new w(0,t.height,h);a.fixedRadius=!0,a.styles.zIndex=t.styles.zIndex,Object.assign(a.styles,r),Object.assign(a.hoverStyles,d),Object.assign(a.activeStyles,l),u(a,s=>{t.width-=s.dx,t.height+=s.dy,t.x+=s.dx,s.x=0},g);const e=new w(t.width,t.height,h);e.fixedRadius=!0,e.styles.zIndex=t.styles.zIndex,Object.assign(e.styles,r),Object.assign(e.hoverStyles,d),Object.assign(e.activeStyles,l),u(e,s=>{t.width+=s.dx,t.height+=s.dy},g);const b=u(t,void 0,g),x=()=>{i.x=0,i.y=0,n.x=t.width,n.y=0,a.x=0,a.y=t.height,e.x=t.width,e.y=t.height};t.addEventListener("beforeRender",x),t.add([i,n,a,e]),t.userData.__controllers=[i,n,a,e];const c=()=>{t.remove([i,n,a,e]),t.removeEventListener("beforeRender",x),b(),t.userData.__controllers=[]};return t.userData.__cancelEdit=c,c}export{p as d,z as e};
