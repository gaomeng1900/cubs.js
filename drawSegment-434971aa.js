import{C as g,e as b,i as w}from"./Test.module-f3780946.js";function O(t,c,d,o=10,s={},i={},l={}){const u=Object.freeze({type:"segmentEdit",target:t,currentTarget:t}),v=()=>{const n={type:"beforeSegmentEdit",target:t,currentTarget:t};c==null||c(n),d==null||d(u)},e=new g(0,0,o);e.fixedRadius=!0,e.radius=o,Object.assign(e.styles,s),Object.assign(e.hoverStyles,i),Object.assign(e.activeStyles,l);const r=new g(t.dx,t.dy,o);r.fixedRadius=!0,r.radius=o,Object.assign(r.styles,s),Object.assign(r.hoverStyles,i),Object.assign(r.activeStyles,l),b(e,n=>{t.dx-=n.dx,t.dy-=n.dy,t.x+=n.dx,t.y+=n.dy},v),b(r,n=>{t.dx+=n.dx,t.dy+=n.dy},v);const x=b(t,void 0,v),a=()=>{e.x=0,e.y=0,r.x=t.dx,r.y=t.dy};t.addEventListener("beforeRender",a),t.add([e,r]),t.userData.__controllers=[e,r];const y=()=>{x(),t.removeEventListener("beforeRender",a),t.remove([e,r]),t.userData.__controllers=[]};return t.userData.__cancelEdit=y,y}function S(t,c,d={}){const o=s=>{const i=s.srcEvent;if(s.target!==s.currentTarget||i.button!==0)return;const{left:l,top:u}=t.canvas.getBoundingClientRect()||{left:0,top:0},v=(i.clientX-l-t.translate.x)/t.scale,e=(i.clientY-u-t.translate.y)/t.scale,r=v,x=e,a=new w(0,0,0,0);a.x=r,a.y=x,Object.assign(a.styles,d),t.add(a);const y=f=>{const p=f.srcEvent,h=(p.clientX-l-t.translate.x)/t.scale,j=(p.clientY-u-t.translate.y)/t.scale;a.dx=h-r,a.dy=j-x},n=f=>{if(t.removeEventListener("pointermove",y),t.removeEventListener("pointerup",n),a.dx===0&&a.dy===0){t.remove(a);return}c==null||c({type:"createSegment",target:a,currentTarget:t})};t.addEventListener("pointermove",y),t.addEventListener("pointerup",n)};return t.addEventListener("pointerdown",o),function(){t.removeEventListener("pointerdown",o)}}export{S as d,O as e};
