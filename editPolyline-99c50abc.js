import{f as j,C as h,d as w}from"./Test.module-daed8981.js";function L(t,i,b,f=10,y={},E={},O={}){const m=Object.freeze({type:"polylineEdit",target:t,currentTarget:t}),d=()=>{const s={type:"beforePolylineEdit",target:t,currentTarget:t};i==null||i(s),b==null||b(m)},x=new j,v=new WeakMap;return t.points.map(s=>{const e=new h(t.x+s.x,t.y+s.y,f);e.fixedRadius=!0,e.radius=f,Object.assign(e.styles,y),Object.assign(e.hoverStyles,E),Object.assign(e.activeStyles,O),v.set(s,e),w(e,r=>{s.x=r.x-t.x,s.y=r.y-t.y},d),x.add(e),e.addEventListener("pointerdown",r=>{if(r.srcEvent.ctrlKey||r.srcEvent.metaKey){const g=t.points.indexOf(s);t.points.splice(g,1),x.remove(e),v.delete(s),d()}})}),t.addEventListener("pointerdown",s=>{if(s.srcEvent.ctrlKey||s.srcEvent.metaKey){const e=s.hitResult;if(!e)return;s.srcEvent.preventDefault(),s.srcEvent.stopPropagation();const r=e.t,g=e.index,u=t.points[g-1]||{x:0,y:0},n=t.points[g]||{x:0,y:0},a={x:u.x+((n==null?void 0:n.x)-u.x)*r,y:u.y+((n==null?void 0:n.y)-u.y)*r};t.points.splice(g,0,a);const c=new h(t.x+a.x,t.y+a.y,f);c.fixedRadius=!0,c.radius=f,Object.assign(c.styles,y),Object.assign(c.hoverStyles,E),Object.assign(c.activeStyles,O),v.set(a,c),w(c,o=>{a.x=o.x-t.x,a.y=o.y-t.y},d),x.add(c),c.addEventListener("pointerdown",o=>{if(o.srcEvent.ctrlKey||o.srcEvent.metaKey){const P=t.points.indexOf(a);t.points.splice(P,1),x.remove(c),v.delete(a),d()}})}}),w(t,void 0,d),t.addEventListener("beforeDraw",s=>{t.points.forEach(e=>{const r=v.get(e);r.x=t.x+e.x,r.y=t.y+e.y})}),x}export{L as e};
