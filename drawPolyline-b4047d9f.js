import{P,C as w,M as v}from"./Test.module-4ee382fa.js";function h(l,y,c={},p={}){let a=!1,e=null,o=null,t=null,n=null;const x=()=>{console.log("drawPolyline: cancel"),l.remove(o),l.remove(t),l.remove(n),l.remove(e),o=null,t=null,n=null,e=null,a=!1},g=r=>{const s=r.srcEvent;if(s.button!==0){a&&x();return}if(a){let u=!1;if(r.target===o&&(console.log("drawPolyline: click on startPoint"),e.closed=!0,u=!0),r.target===t&&(console.log("drawPolyline: click on endPoint"),u=!0),u){console.log("drawPolyline: finished"),l.remove(o),l.remove(t),l.remove(n),e.style.zIndex=c.zIndex,o=null,t=null,n=null,a=!1,e.points.length?y==null||y({type:"createPolyline",target:e,currentTarget:l}):(l.remove(e),console.log("drawPolyline: remove polyline")),e=null;return}else{console.log("drawPolyline: add-point");const d=(s.offsetX-l.translate.x)/l.scale,i=(s.offsetY-l.translate.y)/l.scale;e.points.push({x:d-e.x,y:i-e.y}),t.x=d,t.y=i}}else{if(r.target!==r.currentTarget)return;console.log("drawPolyline: click(init)"),a=!0;const u=(s.offsetX-l.translate.x)/l.scale,d=(s.offsetY-l.translate.y)/l.scale,i=u,f=d;e=new P,e.x=i,e.y=f,e.points.push({x:0,y:0}),Object.assign(e.style,c),n=new v,n.style.fillStyle="blue",n.style.fillOpacity=.1,l.add(n),n.style.zIndex=1e3,e.style.zIndex=1001,l.add(e),o=new w(i,f,5),Object.assign(o.style,p),o.fixedRadius=!0,o.style.zIndex=1002,l.add(o),t=new w(i,f,5),Object.assign(t.style,p),t.fixedRadius=!0,t.style.zIndex=1003,l.add(t)}};l.addEventListener("pointerup",g);const m=r=>{r.key==="Escape"&&a&&x()};return document.addEventListener("keydown",m),function(){l.removeEventListener("pointerup",g),document.removeEventListener("keydown",m)}}export{h as d};
