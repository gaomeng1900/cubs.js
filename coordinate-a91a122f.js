var A=Object.defineProperty;var m=(e,n,s)=>n in e?A(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var E=(e,n,s)=>(m(e,typeof n!="symbol"?n+"":n,s),s);import{r as M,p as D,P as B,R as k,a as b,b as g,E as T,c as H,T as R}from"./Test.module-0a03da6d.js";function F(e,n,s){const{color:y,size:x=10}=s||{},h=new g;return n.map(o=>{const i=o.color??y??M(),r=o.size??x,t=D();t.style.fillStyle=i,t.radius=r,t.addEventListener("beforeRender",d=>{const l=e.project(o.x,o.y);t.x=l[0],t.y=l[1]}),h.add(t)}),h}function O(e,n,s){const{color:y=M(),lineWidth:x=2}=s||{},h=new g,o=n.slice().sort((r,t)=>r.x-t.x),i=new B;return i.style.strokeStyle=y,i.style.lineWidth=x,o.map(r=>{const t=e.project(r.x,r.y);i.points.push({x:t[0],y:t[1]})}),h.addEventListener("beforeRender",r=>{i.points=[],o.map(t=>{const d=e.project(t.x,t.y);i.points.push({x:d[0],y:d[1]})})}),h.add(i),h.userData.polyline=i,h}function U(e,n,s){const{color:y=M(.5),barWidth:x=1}=s||{},h=new g,o=n.slice().sort((r,t)=>r.x-t.x),i=new WeakMap;return o.map(r=>{const t=new k;t.style.fillStyle=r.color??y,h.add(t),i.set(r,t)}),h.addEventListener("beforeRender",r=>{o.map(t=>{const d=i.get(t);if(!d)throw new Error("bar data not found");const[l,c]=e.project(t.x-x/2,0),[a,p]=e.project(t.x+x/2,t.y);d.x=l,d.y=p,d.width=a-l,d.height=c-p})}),h}function q(e,n,s){const{barWidth:y=1}=s||{},x=new g,h=n.slice().sort((r,t)=>r.x-t.x),o=new WeakMap,i=new WeakMap;return h.map(r=>{const t=new k,d=new b;d.style.lineWidth=2,r.open>r.close?(t.style.fillStyle="green",d.style.strokeStyle="green"):(t.style.fillStyle="red",d.style.strokeStyle="red"),x.add(d),x.add(t),o.set(r,t),i.set(r,d)}),x.addEventListener("beforeRender",r=>{h.map(t=>{const d=o.get(t);if(!d)throw new Error("bar data not found");const l=i.get(t);if(!l)throw new Error("shadow data not found");const[c,a]=e.project(t.x-y/2,t.open>t.close?t.open:t.close),[p,u]=e.project(t.x+y/2,t.open>t.close?t.close:t.open);d.x=c,d.y=u,d.width=p-c,d.height=a-u;const f=e.project(t.x,t.high),w=e.project(t.x,t.low);l.x=f[0],l.y=f[1],l.dx=0,l.dy=w[1]-f[1]})}),x}class J extends T{constructor(){super();E(this,"xStart",0);E(this,"xEnd",100);E(this,"yStart",0);E(this,"yEnd",100);E(this,"viewportX",100);E(this,"viewportY",100);E(this,"viewportWidth",400);E(this,"viewportHeight",200);E(this,"indicator",new k);this.indicator.style.stroke=!0,this.indicator.style.fill=!1,this.indicator.style.pointerEvents="none",this.indicator.style.strokeStyle=M(.5),this.indicator.addEventListener("beforeRender",s=>{this.indicator.x=this.viewportX,this.indicator.y=this.viewportY,this.indicator.width=this.viewportWidth,this.indicator.height=this.viewportHeight})}get top(){return this.viewportY}get bottom(){return this.viewportY+this.viewportHeight}get left(){return this.viewportX}get right(){return this.viewportX+this.viewportWidth}project(s,y){const x=(s-this.xStart)/(this.xEnd-this.xStart),h=(y-this.yStart)/(this.yEnd-this.yStart),o=x*this.viewportWidth+this.viewportX,i=-h*this.viewportHeight+this.viewportY+this.viewportHeight;return[o,i]}unproject(s,y){const x=(s-this.viewportX)/this.viewportWidth,h=-(y-this.viewportY-this.viewportHeight)/this.viewportHeight,o=x*(this.xEnd-this.xStart)+this.xStart,i=h*(this.yEnd-this.yStart)+this.yStart;return[o,i]}}function K(e,n,s){const{lockX:y=!1,lockY:x=!1,lockScale:h=!1}=s||{},o=(s==null?void 0:s.xStartMin)??-1/0,i=(s==null?void 0:s.xEndMax)??1/0,r=l=>{const c=l.srcEvent;if(c.button!==2)return;c.preventDefault(),e.cursor="grabbing";const{left:a,top:p}=e.canvas.getBoundingClientRect()||{left:0,top:0},u=c.clientX-a,f=c.clientY-p,w=n.xStart,S=n.xEnd,v=W=>{const X=W.srcEvent,Y=X.clientX-a,j=X.clientY-p,P=(n.xEnd-n.xStart)/n.viewportWidth,I=(n.yEnd-n.yStart)/n.viewportHeight;if(!y){const V=w-(Y-u)*P,C=S-(Y-u)*P;V<o?n.xStart=o:C>i?n.xEnd=i:(n.xStart=V,n.xEnd=C)}x||(n.yStart=n.yStart+(j-f)*I,n.yEnd=n.yEnd+(j-f)*I),n.dispatchEvent({type:"update"})},L=W=>{e.cursor="default",e.removeEventListener("pointermove",v),e.removeEventListener("pointerup",L)};e.addEventListener("pointermove",v),e.addEventListener("pointerup",L)},t=l=>{if(h||l.buttons!==0)return;l.preventDefault();const c=Math.pow(1.1,l.deltaY/50),{left:a,top:p}=e.canvas.getBoundingClientRect()||{left:0,top:0},u=l.clientX-a,f=l.clientY-p,[w,S]=n.unproject(u,f);y||(n.xStart=(n.xStart-w)*c+w,n.xEnd=(n.xEnd-w)*c+w,n.xStart=Math.max(n.xStart,(s==null?void 0:s.xStartMin)??-1/0),n.xEnd=Math.min(n.xEnd,(s==null?void 0:s.xEndMax)??1/0)),x||(n.yStart=(n.yStart-S)*c+S,n.yEnd=(n.yEnd-S)*c+S),n.dispatchEvent({type:"update"})},d=l=>{l.preventDefault()};return e.addEventListener("pointerdown",r),e.canvas.addEventListener("wheel",t),e.canvas.addEventListener("contextmenu",d),function(){e.removeEventListener("pointerdown",r),e.canvas.removeEventListener("wheel",t),e.canvas.removeEventListener("contextmenu",d)}}class N extends g{constructor(n,s){super(),this.coordinator=n,this.config=s;const y=(s==null?void 0:s.followOrigin)??!0,x=(s==null?void 0:s.arrow)??!0,h=((s==null?void 0:s.arrowExtend)??20)*(x?1:0),o=new b;this.add(o),o.style.strokeStyle="red",o.style.lineWidth=2,o.dx=100,o.dy=0;const i=new H;i.points=[{x:10,y:0},{x:0,y:-7},{x:0,y:7}],x&&this.add(i),i.style.fillStyle="red";const r=new b;this.add(r),r.style.strokeStyle="green",r.style.lineWidth=2,r.dx=0,r.dy=-100;const t=new H;t.points=[{x:0,y:-10},{x:7,y:0},{x:-7,y:0}],x&&this.add(t),t.style.fillStyle="green",this.addEventListener("beforeRender",d=>{const l=this.coordinator.viewportX+this.coordinator.viewportWidth,c=this.coordinator.viewportY,a=this.coordinator.viewportX,p=this.coordinator.viewportY+this.coordinator.viewportHeight,u=y?this.coordinator.project(0,0):[a,p];o.x=u[0],o.y=u[1],o.dx=l-o.x+h,i.x=l+h,i.y=u[1],r.x=u[0],r.y=u[1],r.dy=c-r.y-h,t.x=u[0],t.y=c-h})}}function Q(e,n){const s=new g,{minDistance:y=100,xToString:x=i=>i.toFixed(2),yToString:h=i=>i.toFixed(2)}=n||{},o=()=>{s.removeAll();const i=new g,r=new g;{const t=e.viewportWidth,d=e.xEnd-e.xStart,l=t/d,c=Math.pow(10,Math.floor(Math.log10(d/10)));let a=c,p=l*a;p<y&&(a=c*2),p=l*a,p<y&&(a=c*5),p=l*a,p<y&&(a=c*10),p=l*a;const u=Math.ceil(e.xStart/a)*a;for(let f=u;f<=e.xEnd;f+=a){const w=new b;w.style.strokeStyle="red",w.style.lineWidth=2,w.dx=0,w.dy=10;const S=e.project(f,0);w.x=S[0],w.y=e.bottom,i.add(w);const v=new R;v.text=x(f),v.style.fillStyle="red",v.style.textAlign="center",v.style.textBaseline="top",v.style.font="12px sans-serif",v.x=S[0],v.y=e.bottom+20,i.add(v)}}{const t=e.viewportHeight,d=e.yEnd-e.yStart,l=t/d,c=Math.pow(10,Math.floor(Math.log10(d/10)));let a=c,p=l*a;p<y&&(a=c*2),p=l*a,p<y&&(a=c*5),p=l*a,p<y&&(a=c*10),p=l*a;const u=Math.ceil(e.yStart/a)*a;for(let f=u;f<=e.yEnd;f+=a){const w=new b;w.style.strokeStyle="green",w.style.lineWidth=2,w.dx=-10,w.dy=0;const S=e.project(0,f);w.x=e.left,w.y=S[1],r.add(w);const v=new R;v.text=h(f),v.style.fillStyle="green",v.style.textAlign="right",v.style.textBaseline="middle",v.style.font="12px sans-serif",v.x=e.left-15,v.y=S[1],r.add(v)}}s.add(i),s.add(r)};return o(),e.addEventListener("update",i=>{o()}),s}export{J as C,N as a,U as b,K as c,q as d,O as l,F as s,Q as t};
