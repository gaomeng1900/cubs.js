var b=Object.defineProperty;var P=(i,e,t)=>e in i?b(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var p=(i,e,t)=>(P(i,typeof e!="symbol"?e+"":e,t),t);import{_ as w}from"./index-6661360a.js";function q(i,e=200){const[t,s]=w.useState(0),[n,r]=w.useState(0);return w.useEffect(()=>{const a=()=>{const h=i.current;if(!h)return;const o=h.clientWidth,c=h.clientHeight;s(o),r(c)};a();const l=setInterval(a,e);return()=>{clearInterval(l)}},[i,e]),[t,n]}class m{constructor(){p(this,"_listeners",{});p(this,"_options",new WeakMap);p(this,"isEventDispatcher",!0)}addEventListener(e,t,s){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&(n[e].push(t),s!==void 0&&this._options.set(t,s)),this.dispatchEvent({type:"addEventListener",source:{type:e,listener:t,options:s}})}removeEventListener(e,t){const n=this._listeners[e];if(n!==void 0){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}dispatchEvent(e){var n;if(!e.type)throw new Error("event.type is required");const s=this._listeners[e.type];if(s!==void 0){const r=s.slice(0);for(let a=0,l=r.length;a<l;a++){const h=r[a];h.call(this,e),(n=this._options.get(h))!=null&&n.once&&this.removeEventListener(e.type,h)}}}removeAllEventListeners(e){const t=this._listeners;t[e]!==void 0&&(t[e]=[])}}function E(i){const e={...i};return delete e.fill,delete e.stroke,delete e.cursor,delete e.zIndex,delete e.pointerEvents,delete e.fillOpacity,delete e.strokeOpacity,delete e.lineDash,e}class S extends m{constructor(){super(...arguments);p(this,"styles",{fillStyle:"red"});p(this,"hoverStyles",{});p(this,"activeStyles",{});p(this,"x",0);p(this,"y",0);p(this,"visible",!0);p(this,"userData",{});p(this,"_hover",!1);p(this,"_active",!1);p(this,"_scale",1);p(this,"_translate",{x:0,y:0});p(this,"_fill",!0);p(this,"_stroke",!1)}_render(t){t.save(),t.beginPath(),Object.assign(t,E(this.styles)),this._hover&&Object.assign(t,E(this.hoverStyles)),this._active&&Object.assign(t,E(this.activeStyles)),this.styles.lineDash&&t.setLineDash(this.styles.lineDash),this.dispatchEvent({type:"beforeDraw",target:this,currentTarget:this,shape:this,ctx:t}),this.draw(t),t.restore()}localToView(t,s){return{x:(t+this.x)*this._scale+this._translate.x,y:(s+this.y)*this._scale+this._translate.y}}viewToLocal(t,s){return{x:(t-this._translate.x)/this._scale-this.x,y:(s-this._translate.y)/this._scale-this.y}}}class L extends m{constructor(e=[]){super(),this.shapes=e}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return}else this.shapes.push(e),this.dispatchEvent({type:"add",target:e,currentTarget:this})}remove(e){const t=this.shapes.indexOf(e);t!==-1&&(this.shapes.splice(t,1),this.dispatchEvent({type:"remove",target:e,currentTarget:this}))}}class F extends m{constructor(t){super();p(this,"canvas");p(this,"ctx");p(this,"scale",1);p(this,"translate",{x:0,y:0});p(this,"cursor","default");p(this,"children",[]);p(this,"activeShape",null);p(this,"hoveringShape",null);p(this,"rafID",null);p(this,"domListeners",new Set);p(this,"userData",{});this.canvas=t,this.ctx=t.getContext("2d");const s=o=>{this.canvas.setPointerCapture(o.pointerId);const c=o.offsetX,d=o.offsetY,v=this.getHitShape(c,d),u=v==null?void 0:v.shape,y=v==null?void 0:v.res;u&&(this.activeShape=u,u.dispatchEvent({srcEvent:o,type:"pointerdown",target:u,currentTarget:u,hitResult:y})),this.dispatchEvent({srcEvent:o,type:"pointerdown",target:u||this,currentTarget:this})};this.canvas.addEventListener("pointerdown",s),this.domListeners.add([this.canvas,"pointerdown",s]);const n=o=>{this.activeShape?(this.activeShape.dispatchEvent({srcEvent:o,type:"pointerup",target:this.activeShape,currentTarget:this.activeShape}),this.dispatchEvent({srcEvent:o,type:"pointerup",target:this.activeShape,currentTarget:this}),this.activeShape=null,this.canvas.releasePointerCapture(o.pointerId)):this.dispatchEvent({srcEvent:o,type:"pointerup",target:this,currentTarget:this})};this.canvas.addEventListener("pointerup",n),this.domListeners.add([this.canvas,"pointerup",n]);const r=o=>{var v,u;const c=o.offsetX,d=o.offsetY;if(this.checkShapeRef(),this.activeShape)this.activeShape.dispatchEvent({srcEvent:o,type:"pointermove",target:this.activeShape,currentTarget:this.activeShape,hitResult:this.activeShape.hit(c,d,this.ctx)});else{const y=this.getHitShape(c,d),f=(y==null?void 0:y.shape)||null,x=y==null?void 0:y.res;f!==this.hoveringShape&&((v=this.hoveringShape)==null||v.dispatchEvent({srcEvent:o,type:"pointerleave",target:this.hoveringShape,currentTarget:this.hoveringShape}),f==null||f.dispatchEvent({srcEvent:o,type:"pointerenter",target:f,currentTarget:f,hitResult:x}),this.hoveringShape=f),(u=this.hoveringShape)==null||u.dispatchEvent({srcEvent:o,type:"pointermove",target:this.hoveringShape,currentTarget:this.hoveringShape,hitResult:x})}this.dispatchEvent({srcEvent:o,type:"pointermove",target:this.activeShape||this.hoveringShape||this,currentTarget:this})};this.canvas.addEventListener("pointermove",r),this.domListeners.add([this.canvas,"pointermove",r]);const a=o=>{this.dispatchEvent({srcEvent:o,type:"pointerenter",target:this,currentTarget:this})};this.canvas.addEventListener("pointerenter",a),this.domListeners.add([this.canvas,"pointerenter",a]);const l=o=>{this.checkShapeRef(),this.hoveringShape&&(this.hoveringShape.dispatchEvent({srcEvent:o,type:"pointerleave",target:this.hoveringShape,currentTarget:this.hoveringShape}),this.hoveringShape=null),this.dispatchEvent({srcEvent:o,type:"pointerleave",target:this,currentTarget:this})};this.canvas.addEventListener("pointerleave",l),this.domListeners.add([this.canvas,"pointerleave",l]);const h=()=>{this.rafID=requestAnimationFrame(h),this.render()};h()}add(t){this.children.push(t),this.dispatchEvent({type:"add",target:t,currentTarget:this})}remove(t){const s=this.children.indexOf(t);s!==-1&&(this.children.splice(s,1),this.dispatchEvent({type:"remove",target:t,currentTarget:this}))}reset(){this.children=[],this.activeShape=null,this.hoveringShape=null}render(){this.canvas.style.cursor=this.cursor,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const t=this.getShapeList();for(const s of t)s._fill=!0,s._stroke=!1,s._scale=this.scale,s._translate.x=this.translate.x,s._translate.y=this.translate.y,s.visible&&(s.styles.fill!==void 0&&(s._fill=s.styles.fill),s.styles.stroke!==void 0&&(s._stroke=s.styles.stroke),this.hoveringShape===s?(s._hover=!0,s.hoverStyles.cursor&&(this.canvas.style.cursor=s.hoverStyles.cursor),s.hoverStyles.fill!==void 0&&(s._fill=s.hoverStyles.fill),s.hoverStyles.stroke!==void 0&&(s._stroke=!0)):s._hover=!1,this.activeShape===s?(s._active=!0,s.activeStyles.cursor&&(this.canvas.style.cursor=s.activeStyles.cursor),s.activeStyles.fill!==void 0&&(s._fill=s.activeStyles.fill),s.activeStyles.stroke!==void 0&&(s._stroke=s.activeStyles.stroke)):s._active=!1,s._render(this.ctx))}getShapeList(){const t=[];for(const s of this.children)s instanceof L?t.push(...s.shapes):t.push(s);return t.sort((s,n)=>(s.styles.zIndex||0)-(n.styles.zIndex||0)),t}checkShapeRef(){const t=this.getShapeList();this.activeShape&&!t.includes(this.activeShape)&&(this.activeShape=null),this.hoveringShape&&!t.includes(this.hoveringShape)&&(this.hoveringShape=null)}getHitShape(t,s){const n=this.getShapeList();for(let r=n.length-1;r>=0;r--){const a=n[r],l=a.visible&&a.styles.pointerEvents!=="none"&&a.hit(t,s,this.ctx);if(l)return{shape:a,res:l}}}dispose(){this.reset(),this.rafID&&(cancelAnimationFrame(this.rafID),this.rafID=null);for(const[t,s,n]of this.domListeners)t.removeEventListener(s,n);this.domListeners.clear()}fit(t,s,n){const{width:r,height:a}=this.canvas,l=Math.min((r-n*2)/t,(a-n*2)/s);this.scale=l,this.translate.x=(r-t*l)/2,this.translate.y=(a-s*l)/2}}function T(i,e,t,s){const n=t*t+s*s;return(i*t+e*s)/n}function A(i,e,t,s){let n=T(i,e,t,s);n=Math.max(0,Math.min(1,n));const r=n*t,a=n*s;return O(i,e,r,a)}function O(i,e,t,s){return Math.sqrt(W(i,e,t,s))}function W(i,e,t,s){return(i-t)**2+(e-s)**2}class H extends S{constructor(e=0,t=0,s=100,n=100){super(),this.x=e,this.y=t,this.width=s,this.height=n}hit(e,t){const{x:s,y:n}=this.localToView(0,0),{x:r,y:a}=this.localToView(this.width,this.height);return e>=s&&e<=r&&t>=n&&t<=a}draw(e){const{x:t,y:s}=this.localToView(0,0),{x:n,y:r}=this.localToView(this.width,this.height);e.rect(t,s,n-t,r-s),e.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&e.fill(),e.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&e.stroke()}}class U extends S{constructor(t=0,s=0,n=100){super();p(this,"fixedRadius",!1);this.x=t,this.y=s,this.radius=n}hit(t,s){const{x:n,y:r}=this.viewToLocal(t,s);return Math.sqrt(n**2+r**2)<=this.radius/(this.fixedRadius?this._scale:1)}draw(t){const{x:s,y:n}=this.localToView(0,0);t.arc(s,n,this.fixedRadius?this.radius:this.radius*this._scale,0,2*Math.PI),t.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&t.fill(),t.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&t.stroke()}}class _ extends S{constructor(e=0,t=0,s=100,n=100){super(),this.x=e,this.y=t,this.dx=s,this.dy=n,this.styles.fill=!1,this.styles.stroke=!0}hit(e,t){const{x:s,y:n}=this.viewToLocal(e,t),r=A(s,n,this.dx,this.dy);let a=this.styles.lineWidth||2;return this._hover&&(a=this.hoverStyles.lineWidth??a),this._active&&(a=this.activeStyles.lineWidth??a),r<=a/this._scale/2}draw(e){const{x:t,y:s}=this.localToView(0,0),{x:n,y:r}=this.localToView(this.dx,this.dy);e.moveTo(t,s),e.lineTo(n,r),e.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&e.stroke()}}class j extends S{constructor(e=0,t=0,s=[],n=!1){super(),this.x=e,this.y=t,this.points=s,this.closed=n,this.styles.fill=!1,this.styles.stroke=!0}hit(e,t){const{x:s,y:n}=this.viewToLocal(e,t);let r=this.styles.lineWidth||2;this._hover&&(r=this.hoverStyles.lineWidth??r),this._active&&(r=this.activeStyles.lineWidth??r),r=r/this._scale/2;const a=this.closed?this.points.length+1:this.points.length;for(let l=1;l<a;l++){const h=this.points[l-1],o=this.points[l]||this.points[0],c=s-h.x,d=n-h.y,v=o.x-h.x,u=o.y-h.y;let y=T(c,d,v,u);y=Math.max(0,Math.min(1,y));const f=y*v,x=y*u,g=O(c,d,f,x);if(g<=r)return{index:l,distance:g,t:y}}}draw(e){const{x:t,y:s}=this.points[0],{x:n,y:r}=this.localToView(t,s);e.moveTo(n,r);for(let a=1;a<this.points.length;a++){const{x:l,y:h}=this.points[a],{x:o,y:c}=this.localToView(l,h);e.lineTo(o,c)}this.closed&&e.closePath(),e.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&e.stroke()}}class G extends S{constructor(e=0,t=0,s=[]){super(),this.x=e,this.y=t,this.points=s}hit(e,t){const{x:s,y:n}=this.viewToLocal(e,t);let r=!1;for(let a=1;a<=this.points.length;a++){const l=this.points[a-1],h=this.points[a]||this.points[0],o=l.x,c=l.y,d=h.x,v=h.y;c>n!=v>n&&s<(d-o)*(n-c)/(v-c)+o&&(r=!r)}return r}draw(e){const{x:t,y:s}=this.points[0],{x:n,y:r}=this.localToView(t,s);e.moveTo(n,r);for(let a=1;a<this.points.length;a++){const{x:l,y:h}=this.points[a],{x:o,y:c}=this.localToView(l,h);e.lineTo(o,c)}e.closePath(),e.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&e.fill(),e.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&e.stroke()}}class J extends S{constructor(){super(...arguments);p(this,"styles",{fillStyle:"white",fillOpacity:.5})}hit(t,s){return!0}draw(t){const{width:s,height:n}=t.canvas;t.rect(0,0,s,n),t.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&t.fill(),t.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&t.stroke()}}class K extends S{constructor(e){super(),this.path=e}hit(e,t,s){const{x:n,y:r}=this.viewToLocal(e,t);return s.isPointInPath(this.path,n,r)}draw(e){e.translate(this._translate.x,this._translate.y),e.scale(this._scale,this._scale),e.translate(this.x,this.y),e.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&e.fill(this.path),e.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&e.stroke(this.path)}}class k extends S{constructor(t=0,s=0,n="",r){super();p(this,"fixedSize",!1);p(this,"textMetrics");this.x=t,this.y=s,this.text=n,this.maxWidth=r,this.styles.font="30px monospace"}hit(t,s,n){if(this.textMetrics===void 0)return!1;const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l}=this.textMetrics,h=this.x*this._scale+this._translate.x,o=h+r*(this.fixedSize?1:this._scale),c=this.y*this._scale+this._translate.y-a*(this.fixedSize?1:this._scale),d=c+(a+l)*(this.fixedSize?1:this._scale);return t>=h&&t<=o&&s>=c&&s<=d}draw(t){t.translate(this._translate.x,this._translate.y),t.scale(this._scale,this._scale),t.translate(this.x,this.y),this.fixedSize&&t.scale(1/this._scale,1/this._scale),t.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&t.fillText(this.text,0,0,this.maxWidth),t.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&t.strokeText(this.text,0,0,this.maxWidth),this.textMetrics=t.measureText(this.text)}}function N(i,e,t){let s=0,n=0,r=!1,a=0,l=0;i.hoverStyles.cursor="move";function h(d){d.srcEvent.button===0&&(s=d.srcEvent.offsetX,n=d.srcEvent.offsetY,a=i.x,l=i.y,r=!0)}function o(d){if(r){const v=d.srcEvent.offsetX-s,u=d.srcEvent.offsetY-n,y=a+v/i._scale,f=l+u/i._scale,x={type:"drag",x:y,y:f,srcEvent:d.srcEvent,target:i,currentTarget:i};e==null||e(x),i.x=x.x,i.y=x.y}}function c(d){r=!1,t==null||t({type:"afterDrag",srcEvent:d.srcEvent,target:i,currentTarget:i})}return i.addEventListener("pointerdown",h),i.addEventListener("pointermove",o),i.addEventListener("pointerup",c),function(){i.removeEventListener("pointerdown",h),i.removeEventListener("pointermove",o),i.removeEventListener("pointerup",c)}}function Q(i){const e=n=>{const r=n.srcEvent;if(r.button!==2)return;r.preventDefault(),i.cursor="grabbing";const{left:a,top:l}=i.canvas.getBoundingClientRect()||{left:0,top:0},h=r.clientX-a,o=r.clientY-l,c=i.translate.x,d=i.translate.y,v=y=>{const f=y.srcEvent,x=f.clientX-a,g=f.clientY-l;i.translate.x=c+x-h,i.translate.y=d+g-o},u=y=>{i.cursor="default",i.removeEventListener("pointermove",v),i.removeEventListener("pointerup",u)};i.addEventListener("pointermove",v),i.addEventListener("pointerup",u)},t=n=>{if(n.buttons!==0)return;n.preventDefault();const r=Math.pow(1.1,-n.deltaY/50);i.scale*=r;const{left:a,top:l}=i.canvas.getBoundingClientRect()||{left:0,top:0},h=n.clientX-a,o=n.clientY-l,c=h-i.translate.x,d=o-i.translate.y;i.translate.x+=c-c*r,i.translate.y+=d-d*r},s=n=>{n.preventDefault()};return i.addEventListener("pointerdown",e),i.canvas.addEventListener("wheel",t),i.canvas.addEventListener("contextmenu",s),function(){i.removeEventListener("pointerdown",e),i.canvas.removeEventListener("wheel",t),i.canvas.removeEventListener("contextmenu",s)}}function Z(i){const e=new L,t=new _;e.add(t),t.styles.strokeStyle="red",t.styles.lineWidth=2,t.dx=0,t.dy=0;const s=new _;e.add(s),s.styles.strokeStyle="red",s.styles.lineWidth=2,s.dx=-10,s.dy=-10;const n=new _;e.add(n),n.styles.strokeStyle="red",n.styles.lineWidth=2,n.dx=-10,n.dy=10,t.addEventListener("beforeDraw",v=>{t.dx=i.canvas.width/i.scale,t.x=-i.translate.x/i.scale,s.x=t.x+t.dx,s.dx=-10/i.scale,s.dy=-10/i.scale,n.x=t.x+t.dx,n.dx=-10/i.scale,n.dy=10/i.scale});const r=new _;e.add(r),r.styles.strokeStyle="green",r.styles.lineWidth=2,r.dx=0,r.dy=0;const a=new _;e.add(a),a.styles.strokeStyle="green",a.styles.lineWidth=2,a.dx=-10,a.dy=-10;const l=new _;e.add(l),l.styles.strokeStyle="green",l.styles.lineWidth=2,l.dx=10,l.dy=-10,r.addEventListener("beforeDraw",v=>{r.dy=i.canvas.height/i.scale,r.y=-i.translate.y/i.scale,a.y=r.y+r.dy,a.dx=-10/i.scale,a.dy=-10/i.scale,l.y=r.y+r.dy,l.dx=10/i.scale,l.dy=-10/i.scale});const h=new _;e.add(h),h.styles.strokeStyle="green",h.styles.strokeOpacity=.5,h.styles.lineDash=[5,5],h.styles.lineWidth=2,h.dx=0,h.dy=0;const o=new _;e.add(o),o.styles.strokeStyle="red",o.styles.strokeOpacity=.5,o.styles.lineDash=[5,5],o.styles.lineWidth=2,o.dx=0,o.dy=0;const c=new k;e.add(c),c.styles.fillStyle="red",c.styles.fillOpacity=.7,c.styles.font="15px monospace",c.fixedSize=!0;const d=new k;return e.add(d),d.styles.fillStyle="green",d.styles.fillOpacity=.7,d.styles.font="15px monospace",d.fixedSize=!0,i.addEventListener("pointermove",v=>{const u=v.srcEvent.offsetX,y=v.srcEvent.offsetY,f=(u-i.translate.x)/i.scale,x=(y-i.translate.y)/i.scale;o.x=f,o.dy=x,h.y=x,h.dx=f;const g=5/i.scale;c.x=f+g,c.styles.textBaseline=x>0?"top":"bottom",c.y=x>0?g:-g,c.text=f.toFixed(2),d.y=x-g,d.styles.textAlign=f>0?"left":"right",d.x=f>0?g:-g,d.text=x.toFixed(2)}),e.shapes.forEach(v=>{v.styles.pointerEvents="none",v.styles.zIndex=-1}),i.add(e),()=>{i.remove(e)}}const D="_wrapper_1r0xy_3",Y="_tools_1r0xy_16",X="_main_1r0xy_23",M="_mainPaper_1r0xy_42 _main_1r0xy_23",R="_canvas_1r0xy_58",I="_svgOuterWrapper_1r0xy_62",V="_svgWrapper_1r0xy_66",z="_footer_1r0xy_71",$={wrapper:D,tools:Y,main:X,mainPaper:M,canvas:R,svgOuterWrapper:I,svgWrapper:V,footer:z};export{U as C,J as M,j as P,H as R,F as S,Z as a,$ as b,L as c,N as d,_ as e,G as f,K as g,Q as s,q as u};
