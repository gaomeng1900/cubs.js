var O=Object.defineProperty;var b=(i,s,t)=>s in i?O(i,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[s]=t;var v=(i,s,t)=>(b(i,typeof s!="symbol"?s+"":s,t),t);import{_ as w}from"./index-eb33cad6.js";function C(i,s=200){const[t,e]=w.useState(0),[n,r]=w.useState(0);return w.useEffect(()=>{const a=()=>{const h=i.current;if(!h)return;const d=h.clientWidth,o=h.clientHeight;e(d),r(o)};a();const l=setInterval(a,s);return()=>{clearInterval(l)}},[i,s]),[t,n]}class m{constructor(){v(this,"_listeners",{});v(this,"_options",new WeakMap);v(this,"isEventDispatcher",!0)}addEventListener(s,t,e){const n=this._listeners;n[s]===void 0&&(n[s]=[]),n[s].indexOf(t)===-1&&(n[s].push(t),e!==void 0&&this._options.set(t,e)),this.dispatchEvent({type:"addEventListener",source:{type:s,listener:t,options:e}})}removeEventListener(s,t){const n=this._listeners[s];if(n!==void 0){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}dispatchEvent(s){var n;if(!s.type)throw new Error("event.type is required");const e=this._listeners[s.type];if(e!==void 0){const r=e.slice(0);for(let a=0,l=r.length;a<l;a++){const h=r[a];h.call(this,s),(n=this._options.get(h))!=null&&n.once&&this.removeEventListener(s.type,h)}}}removeAllEventListeners(s){const t=this._listeners;t[s]!==void 0&&(t[s]=[])}}function E(i){const s={...i};return delete s.fill,delete s.stroke,delete s.cursor,delete s.zIndex,delete s.pointerEvents,delete s.fillOpacity,delete s.strokeOpacity,delete s.lineDash,s}class _ extends m{constructor(){super(...arguments);v(this,"styles",{fillStyle:"red"});v(this,"hoverStyles",{});v(this,"activeStyles",{});v(this,"x",0);v(this,"y",0);v(this,"visible",!0);v(this,"userData",{});v(this,"_hover",!1);v(this,"_active",!1);v(this,"_scale",1);v(this,"_translate",{x:0,y:0});v(this,"_fill",!0);v(this,"_stroke",!1)}_render(t){t.save(),t.beginPath(),Object.assign(t,E(this.styles)),this._hover&&Object.assign(t,E(this.hoverStyles)),this._active&&Object.assign(t,E(this.activeStyles)),this.styles.lineDash&&t.setLineDash(this.styles.lineDash),this.dispatchEvent({type:"beforeDraw",target:this,currentTarget:this,shape:this,ctx:t}),this.draw(t),t.restore()}localToView(t,e){return{x:(t+this.x)*this._scale+this._translate.x,y:(e+this.y)*this._scale+this._translate.y}}viewToLocal(t,e){return{x:(t-this._translate.x)/this._scale-this.x,y:(e-this._translate.y)/this._scale-this.y}}}class k extends m{constructor(s=[]){super(),this.shapes=s}add(s){if(Array.isArray(s)){for(const t of s)this.add(t);return}else this.shapes.push(s),this.dispatchEvent({type:"add",target:s,currentTarget:this})}remove(s){const t=this.shapes.indexOf(s);t!==-1&&(this.shapes.splice(t,1),this.dispatchEvent({type:"remove",target:s,currentTarget:this}))}}class q extends m{constructor(t){super();v(this,"canvas");v(this,"ctx");v(this,"scale",1);v(this,"translate",{x:0,y:0});v(this,"cursor","default");v(this,"maxFPS",60);v(this,"children",[]);v(this,"activeShape",null);v(this,"hoveringShape",null);v(this,"rafID",null);v(this,"domListeners",new Set);v(this,"userData",{});this.canvas=t,this.ctx=t.getContext("2d");const e=o=>{this.canvas.setPointerCapture(o.pointerId);const c=o.offsetX,p=o.offsetY,x=this.getHitShape(c,p),y=x==null?void 0:x.shape,f=x==null?void 0:x.res;y&&(this.activeShape=y,y.dispatchEvent({srcEvent:o,type:"pointerdown",target:y,currentTarget:y,hitResult:f})),this.dispatchEvent({srcEvent:o,type:"pointerdown",target:y||this,currentTarget:this})};this.canvas.addEventListener("pointerdown",e),this.domListeners.add([this.canvas,"pointerdown",e]);const n=o=>{this.activeShape?(this.activeShape.dispatchEvent({srcEvent:o,type:"pointerup",target:this.activeShape,currentTarget:this.activeShape}),this.dispatchEvent({srcEvent:o,type:"pointerup",target:this.activeShape,currentTarget:this}),this.activeShape=null,this.canvas.releasePointerCapture(o.pointerId)):this.dispatchEvent({srcEvent:o,type:"pointerup",target:this,currentTarget:this})};this.canvas.addEventListener("pointerup",n),this.domListeners.add([this.canvas,"pointerup",n]);const r=o=>{var x,y;const c=o.offsetX,p=o.offsetY;if(this.checkShapeRef(),this.activeShape)this.activeShape.dispatchEvent({srcEvent:o,type:"pointermove",target:this.activeShape,currentTarget:this.activeShape,hitResult:this.activeShape.hit(c,p,this.ctx)});else{const f=this.getHitShape(c,p),u=(f==null?void 0:f.shape)||null,g=f==null?void 0:f.res;u!==this.hoveringShape&&((x=this.hoveringShape)==null||x.dispatchEvent({srcEvent:o,type:"pointerleave",target:this.hoveringShape,currentTarget:this.hoveringShape}),u==null||u.dispatchEvent({srcEvent:o,type:"pointerenter",target:u,currentTarget:u,hitResult:g}),this.hoveringShape=u),(y=this.hoveringShape)==null||y.dispatchEvent({srcEvent:o,type:"pointermove",target:this.hoveringShape,currentTarget:this.hoveringShape,hitResult:g})}this.dispatchEvent({srcEvent:o,type:"pointermove",target:this.activeShape||this.hoveringShape||this,currentTarget:this})};this.canvas.addEventListener("pointermove",r),this.domListeners.add([this.canvas,"pointermove",r]);const a=o=>{this.dispatchEvent({srcEvent:o,type:"pointerenter",target:this,currentTarget:this})};this.canvas.addEventListener("pointerenter",a),this.domListeners.add([this.canvas,"pointerenter",a]);const l=o=>{this.checkShapeRef(),this.hoveringShape&&(this.hoveringShape.dispatchEvent({srcEvent:o,type:"pointerleave",target:this.hoveringShape,currentTarget:this.hoveringShape}),this.hoveringShape=null),this.dispatchEvent({srcEvent:o,type:"pointerleave",target:this,currentTarget:this})};this.canvas.addEventListener("pointerleave",l),this.domListeners.add([this.canvas,"pointerleave",l]);let h=null;const d=o=>{if(h!==null&&o!==null){const c=1e3/this.maxFPS-5;if(o-h<c){this.rafID=requestAnimationFrame(d);return}}h=o,this.rafID=requestAnimationFrame(d),this.render()};d(null)}add(t){this.children.push(t),this.dispatchEvent({type:"add",target:t,currentTarget:this})}remove(t){const e=this.children.indexOf(t);e!==-1&&(this.children.splice(e,1),this.dispatchEvent({type:"remove",target:t,currentTarget:this}))}reset(){this.children=[],this.activeShape=null,this.hoveringShape=null}render(){this.dispatchEvent({type:"beforeRender",target:this,currentTarget:this}),this.canvas.style.cursor=this.cursor,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const t=this.getShapeList();for(const e of t)e._fill=!0,e._stroke=!1,e._scale=this.scale,e._translate.x=this.translate.x,e._translate.y=this.translate.y,e.visible&&(e.styles.fill!==void 0&&(e._fill=e.styles.fill),e.styles.stroke!==void 0&&(e._stroke=e.styles.stroke),this.hoveringShape===e?(e._hover=!0,e.hoverStyles.cursor&&(this.canvas.style.cursor=e.hoverStyles.cursor),e.hoverStyles.fill!==void 0&&(e._fill=e.hoverStyles.fill),e.hoverStyles.stroke!==void 0&&(e._stroke=!0)):e._hover=!1,this.activeShape===e?(e._active=!0,e.activeStyles.cursor&&(this.canvas.style.cursor=e.activeStyles.cursor),e.activeStyles.fill!==void 0&&(e._fill=e.activeStyles.fill),e.activeStyles.stroke!==void 0&&(e._stroke=e.activeStyles.stroke)):e._active=!1,e._render(this.ctx))}getShapeList(){const t=[];for(const e of this.children)e instanceof k?t.push(...e.shapes):t.push(e);return t.sort((e,n)=>(e.styles.zIndex||0)-(n.styles.zIndex||0)),t}checkShapeRef(){const t=this.getShapeList();this.activeShape&&!t.includes(this.activeShape)&&(this.activeShape=null),this.hoveringShape&&!t.includes(this.hoveringShape)&&(this.hoveringShape=null)}getHitShape(t,e){const n=this.getShapeList();for(let r=n.length-1;r>=0;r--){const a=n[r],l=a.visible&&a.styles.pointerEvents!=="none"&&a.hit(t,e,this.ctx);if(l)return{shape:a,res:l}}}dispose(){this.reset(),this.rafID&&(cancelAnimationFrame(this.rafID),this.rafID=null);for(const[t,e,n]of this.domListeners)t.removeEventListener(e,n);this.domListeners.clear()}fit(t,e,n){const{width:r,height:a}=this.canvas,l=Math.min((r-n*2)/t,(a-n*2)/e);this.scale=l,this.translate.x=(r-t*l)/2,this.translate.y=(a-e*l)/2}}function T(i,s,t,e){const n=t*t+e*e;return(i*t+s*e)/n}function A(i,s,t,e){let n=T(i,s,t,e);n=Math.max(0,Math.min(1,n));const r=n*t,a=n*e;return P(i,s,r,a)}function P(i,s,t,e){return Math.sqrt(D(i,s,t,e))}function D(i,s,t,e){return(i-t)**2+(s-e)**2}class H extends _{constructor(s=0,t=0,e=100,n=100){super(),this.x=s,this.y=t,this.width=e,this.height=n}hit(s,t){const{x:e,y:n}=this.localToView(0,0),{x:r,y:a}=this.localToView(this.width,this.height);return s>=e&&s<=r&&t>=n&&t<=a}draw(s){const{x:t,y:e}=this.localToView(0,0),{x:n,y:r}=this.localToView(this.width,this.height);s.rect(t,e,n-t,r-e),s.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&s.fill(),s.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&s.stroke()}}class U extends _{constructor(t=0,e=0,n=100){super();v(this,"fixedRadius",!1);this.x=t,this.y=e,this.radius=n}hit(t,e){const{x:n,y:r}=this.viewToLocal(t,e);return Math.sqrt(n**2+r**2)<=this.radius/(this.fixedRadius?this._scale:1)}draw(t){const{x:e,y:n}=this.localToView(0,0);t.arc(e,n,this.fixedRadius?this.radius:this.radius*this._scale,0,2*Math.PI),t.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&t.fill(),t.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&t.stroke()}}class S extends _{constructor(s=0,t=0,e=100,n=100){super(),this.x=s,this.y=t,this.dx=e,this.dy=n,this.styles.fill=!1,this.styles.stroke=!0}hit(s,t){const{x:e,y:n}=this.viewToLocal(s,t),r=A(e,n,this.dx,this.dy);let a=this.styles.lineWidth||2;return this._hover&&(a=this.hoverStyles.lineWidth??a),this._active&&(a=this.activeStyles.lineWidth??a),r<=a/this._scale/2}draw(s){const{x:t,y:e}=this.localToView(0,0),{x:n,y:r}=this.localToView(this.dx,this.dy);s.moveTo(t,e),s.lineTo(n,r),s.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&s.stroke()}}class j extends _{constructor(s=0,t=0,e=[],n=!1){super(),this.x=s,this.y=t,this.points=e,this.closed=n,this.styles.fill=!1,this.styles.stroke=!0}hit(s,t){const{x:e,y:n}=this.viewToLocal(s,t);let r=this.styles.lineWidth||2;this._hover&&(r=this.hoverStyles.lineWidth??r),this._active&&(r=this.activeStyles.lineWidth??r),r=r/this._scale/2;const a=this.closed?this.points.length+1:this.points.length;for(let l=1;l<a;l++){const h=this.points[l-1],d=this.points[l]||this.points[0],o=e-h.x,c=n-h.y,p=d.x-h.x,x=d.y-h.y;let y=T(o,c,p,x);y=Math.max(0,Math.min(1,y));const f=y*p,u=y*x,g=P(o,c,f,u);if(g<=r)return{index:l,distance:g,t:y}}}draw(s){const{x:t,y:e}=this.points[0],{x:n,y:r}=this.localToView(t,e);s.moveTo(n,r);for(let a=1;a<this.points.length;a++){const{x:l,y:h}=this.points[a],{x:d,y:o}=this.localToView(l,h);s.lineTo(d,o)}this.closed&&s.closePath(),s.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&s.stroke()}}class G extends _{constructor(s=0,t=0,e=[]){super(),this.x=s,this.y=t,this.points=e}hit(s,t){const{x:e,y:n}=this.viewToLocal(s,t);let r=!1;for(let a=1;a<=this.points.length;a++){const l=this.points[a-1],h=this.points[a]||this.points[0],d=l.x,o=l.y,c=h.x,p=h.y;o>n!=p>n&&e<(c-d)*(n-o)/(p-o)+d&&(r=!r)}return r}draw(s){const{x:t,y:e}=this.points[0],{x:n,y:r}=this.localToView(t,e);s.moveTo(n,r);for(let a=1;a<this.points.length;a++){const{x:l,y:h}=this.points[a],{x:d,y:o}=this.localToView(l,h);s.lineTo(d,o)}s.closePath(),s.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&s.fill(),s.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&s.stroke()}}class $ extends _{constructor(){super(...arguments);v(this,"styles",{fillStyle:"white",fillOpacity:.5})}hit(t,e){return!0}draw(t){const{width:e,height:n}=t.canvas;t.rect(0,0,e,n),t.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&t.fill(),t.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&t.stroke()}}class J extends _{constructor(s){super(),this.path=s}hit(s,t,e){const{x:n,y:r}=this.viewToLocal(s,t);return e.isPointInPath(this.path,n,r)}draw(s){s.translate(this._translate.x,this._translate.y),s.scale(this._scale,this._scale),s.translate(this.x,this.y),s.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&s.fill(this.path),s.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&s.stroke(this.path)}}class L extends _{constructor(t=0,e=0,n="",r){super();v(this,"fixedSize",!1);v(this,"textMetrics");this.x=t,this.y=e,this.text=n,this.maxWidth=r,this.styles.font="30px monospace"}hit(t,e,n){if(this.textMetrics===void 0)return!1;const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l}=this.textMetrics,h=this.x*this._scale+this._translate.x,d=h+r*(this.fixedSize?1:this._scale),o=this.y*this._scale+this._translate.y-a*(this.fixedSize?1:this._scale),c=o+(a+l)*(this.fixedSize?1:this._scale);return t>=h&&t<=d&&e>=o&&e<=c}draw(t){t.translate(this._translate.x,this._translate.y),t.scale(this._scale,this._scale),t.translate(this.x,this.y),this.fixedSize&&t.scale(1/this._scale,1/this._scale),t.globalAlpha=this.styles.fillOpacity===void 0?1:this.styles.fillOpacity,this._fill&&t.fillText(this.text,0,0,this.maxWidth),t.globalAlpha=this.styles.strokeOpacity===void 0?1:this.styles.strokeOpacity,this._stroke&&t.strokeText(this.text,0,0,this.maxWidth),this.textMetrics=t.measureText(this.text)}}function K(i,s,t){let e=0,n=0,r=!1,a=0,l=0;i.hoverStyles.cursor="move";function h(c){c.srcEvent.button===0&&(e=c.srcEvent.offsetX,n=c.srcEvent.offsetY,a=i.x,l=i.y,r=!0)}function d(c){if(r){const p=c.srcEvent.offsetX-e,x=c.srcEvent.offsetY-n,y=a+p/i._scale,f=l+x/i._scale,u={type:"drag",x:y,y:f,srcEvent:c.srcEvent,target:i,currentTarget:i};s==null||s(u),i.x=u.x,i.y=u.y}}function o(c){r=!1,t==null||t({type:"afterDrag",srcEvent:c.srcEvent,target:i,currentTarget:i})}return i.addEventListener("pointerdown",h),i.addEventListener("pointermove",d),i.addEventListener("pointerup",o),function(){i.removeEventListener("pointerdown",h),i.removeEventListener("pointermove",d),i.removeEventListener("pointerup",o)}}function N(i){const s=n=>{const r=n.srcEvent;if(r.button!==2)return;r.preventDefault(),i.cursor="grabbing";const{left:a,top:l}=i.canvas.getBoundingClientRect()||{left:0,top:0},h=r.clientX-a,d=r.clientY-l,o=i.translate.x,c=i.translate.y,p=y=>{const f=y.srcEvent,u=f.clientX-a,g=f.clientY-l;i.translate.x=o+u-h,i.translate.y=c+g-d},x=y=>{i.cursor="default",i.removeEventListener("pointermove",p),i.removeEventListener("pointerup",x)};i.addEventListener("pointermove",p),i.addEventListener("pointerup",x)},t=n=>{if(n.buttons!==0)return;n.preventDefault();const r=Math.pow(1.1,-n.deltaY/50);i.scale*=r;const{left:a,top:l}=i.canvas.getBoundingClientRect()||{left:0,top:0},h=n.clientX-a,d=n.clientY-l,o=h-i.translate.x,c=d-i.translate.y;i.translate.x+=o-o*r,i.translate.y+=c-c*r},e=n=>{n.preventDefault()};return i.addEventListener("pointerdown",s),i.canvas.addEventListener("wheel",t),i.canvas.addEventListener("contextmenu",e),function(){i.removeEventListener("pointerdown",s),i.canvas.removeEventListener("wheel",t),i.canvas.removeEventListener("contextmenu",e)}}function Q(i){const s=new k,t=new S;s.add(t),t.styles.strokeStyle="red",t.styles.lineWidth=2,t.dx=0,t.dy=0;const e=new S;s.add(e),e.styles.strokeStyle="red",e.styles.lineWidth=2,e.dx=-10,e.dy=-10;const n=new S;s.add(n),n.styles.strokeStyle="red",n.styles.lineWidth=2,n.dx=-10,n.dy=10,t.addEventListener("beforeDraw",p=>{t.dx=i.canvas.width/i.scale,t.x=-i.translate.x/i.scale,e.x=t.x+t.dx,e.dx=-10/i.scale,e.dy=-10/i.scale,n.x=t.x+t.dx,n.dx=-10/i.scale,n.dy=10/i.scale});const r=new S;s.add(r),r.styles.strokeStyle="green",r.styles.lineWidth=2,r.dx=0,r.dy=0;const a=new S;s.add(a),a.styles.strokeStyle="green",a.styles.lineWidth=2,a.dx=-10,a.dy=-10;const l=new S;s.add(l),l.styles.strokeStyle="green",l.styles.lineWidth=2,l.dx=10,l.dy=-10,r.addEventListener("beforeDraw",p=>{r.dy=i.canvas.height/i.scale,r.y=-i.translate.y/i.scale,a.y=r.y+r.dy,a.dx=-10/i.scale,a.dy=-10/i.scale,l.y=r.y+r.dy,l.dx=10/i.scale,l.dy=-10/i.scale});const h=new S;s.add(h),h.styles.strokeStyle="green",h.styles.strokeOpacity=.5,h.styles.lineDash=[5,5],h.styles.lineWidth=2,h.dx=0,h.dy=0;const d=new S;s.add(d),d.styles.strokeStyle="red",d.styles.strokeOpacity=.5,d.styles.lineDash=[5,5],d.styles.lineWidth=2,d.dx=0,d.dy=0;const o=new L;s.add(o),o.styles.fillStyle="red",o.styles.fillOpacity=.7,o.styles.font="15px monospace",o.fixedSize=!0;const c=new L;return s.add(c),c.styles.fillStyle="green",c.styles.fillOpacity=.7,c.styles.font="15px monospace",c.fixedSize=!0,i.addEventListener("pointermove",p=>{const x=p.srcEvent.offsetX,y=p.srcEvent.offsetY,f=(x-i.translate.x)/i.scale,u=(y-i.translate.y)/i.scale;d.x=f,d.dy=u,h.y=u,h.dx=f;const g=5/i.scale;o.x=f+g,o.styles.textBaseline=u>0?"top":"bottom",o.y=u>0?g:-g,o.text=f.toFixed(2),c.y=u-g,c.styles.textAlign=f>0?"left":"right",c.x=f>0?g:-g,c.text=u.toFixed(2)}),s.shapes.forEach(p=>{p.styles.pointerEvents="none",p.styles.zIndex=-1}),i.add(s),()=>{i.remove(s)}}function Z(i,s=5,t){const e=t||i.maxFPS;i.maxFPS=s;let n=!1,r=!1;const a=()=>{n=!0,i.maxFPS=e},l=()=>{n=!1,r||(i.maxFPS=s)},h=()=>{r=!0,i.maxFPS=e},d=()=>{r=!1,n||(i.maxFPS=s)},o=()=>{r=!0,i.maxFPS=e};return i.addEventListener("pointerdown",a),i.addEventListener("pointerup",l),i.addEventListener("pointerenter",h),i.addEventListener("pointerleave",d),i.addEventListener("pointermove",o),()=>{i.removeEventListener("pointerdown",a),i.removeEventListener("pointerup",l),i.removeEventListener("pointerenter",h),i.removeEventListener("pointerleave",d),i.removeEventListener("pointermove",o)}}function tt(i){var r;let s=0,t=0;const e=document.createElement("div");e.style.position="absolute",e.style.right="0",e.style.bottom="0",e.style.textShadow="white",e.style.color="black",e.style.fontFamily="monospace",e.style.pointerEvents="none";const n=()=>{const a=performance.now(),l=a-s;s=a;const h=Math.round(1e3/l);h!==t&&(t=h,e.innerText=`${h} FPS`)};return i.addEventListener("beforeRender",n),(r=i.canvas.parentElement)==null||r.appendChild(e),()=>{i.removeEventListener("beforeRender",n),e.remove()}}const W="_wrapper_1r0xy_3",Y="_tools_1r0xy_16",X="_main_1r0xy_23",M="_mainPaper_1r0xy_42 _main_1r0xy_23",F="_canvas_1r0xy_58",R="_svgOuterWrapper_1r0xy_62",I="_svgWrapper_1r0xy_66",V="_footer_1r0xy_71",et={wrapper:W,tools:Y,main:X,mainPaper:M,canvas:F,svgOuterWrapper:R,svgWrapper:I,footer:V};export{U as C,$ as M,j as P,H as R,q as S,Q as a,Z as b,et as c,K as d,S as e,k as f,G as g,J as h,tt as i,N as s,C as u};
