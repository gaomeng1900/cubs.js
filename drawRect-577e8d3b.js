import{C as w,d as u,l as f,R}from"./Test.module-0a03da6d.js";function L(t,h,y,o=10,r={},d={},l={}){const v=Object.freeze({type:"rectEdit",target:t,currentTarget:t}),g=()=>{const n={type:"beforeRectEdit",target:t,currentTarget:t};f(t),h==null||h(n),y==null||y(v)},i=new w(0,0,o);i.fixedRadius=!0,Object.assign(i.style,r),Object.assign(i.hoverStyle,d),Object.assign(i.activeStyle,l),u(i,n=>{t.x+=n.dx,t.y+=n.dy,t.width-=n.dx,t.height-=n.dy,n.x=0,n.y=0},g);const a=new w(t.width,0,o);a.fixedRadius=!0,a.style.zIndex=t.style.zIndex,Object.assign(a.style,r),Object.assign(a.hoverStyle,d),Object.assign(a.activeStyle,l),u(a,n=>{t.width+=n.dx,t.height-=n.dy,t.y+=n.dy,n.y=0},g);const s=new w(0,t.height,o);s.fixedRadius=!0,s.style.zIndex=t.style.zIndex,Object.assign(s.style,r),Object.assign(s.hoverStyle,d),Object.assign(s.activeStyle,l),u(s,n=>{t.width-=n.dx,t.height+=n.dy,t.x+=n.dx,n.x=0},g);const e=new w(t.width,t.height,o);e.fixedRadius=!0,e.style.zIndex=t.style.zIndex,Object.assign(e.style,r),Object.assign(e.hoverStyle,d),Object.assign(e.activeStyle,l),u(e,n=>{t.width+=n.dx,t.height+=n.dy},g);const b=u(t,void 0,g),x=()=>{i.x=0,i.y=0,a.x=t.width,a.y=0,s.x=0,s.y=t.height,e.x=t.width,e.y=t.height};t.addEventListener("beforeRender",x),t.add([i,a,s,e]),t.userData.__controllers=[i,a,s,e];const c=()=>{t.remove([i,a,s,e]),t.removeEventListener("beforeRender",x),b(),t.userData.__controllers=[]};return t.userData.__cancelEdit=c,c}function z(t,h,y={}){const o=r=>{const d=r.srcEvent;if(r.target!==r.currentTarget||d.button!==0)return;const{left:l,top:v}=t.canvas.getBoundingClientRect()||{left:0,top:0},g=(d.clientX-l-t.translate.x)/t.scale,i=(d.clientY-v-t.translate.y)/t.scale,a=g,s=i,e=new R(0,0,0,0);e.x=a,e.y=s,e.width=0,e.height=0,Object.assign(e.style,y),t.add(e);const b=c=>{const n=c.srcEvent,j=(n.clientX-l-t.translate.x)/t.scale,O=(n.clientY-v-t.translate.y)/t.scale;e.width=j-a,e.height=O-s},x=c=>{if(t.removeEventListener("pointermove",b),t.removeEventListener("pointerup",x),f(e),e.width===0||e.height===0){t.remove(e);return}h==null||h({type:"rectCreation",target:e,currentTarget:t})};t.addEventListener("pointermove",b),t.addEventListener("pointerup",x)};return t.addEventListener("pointerdown",o),function(){t.removeEventListener("pointerdown",o)}}export{z as d,L as e};
