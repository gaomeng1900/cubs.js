import{g as P,C as w,M as v}from"./Test.module-f3780946.js";function h(l,y,c={},p={}){let a=!1,e=null,o=null,t=null,n=null;const g=()=>{console.log("drawPolyline: cancel"),l.remove(o),l.remove(t),l.remove(n),l.remove(e),o=null,t=null,n=null,e=null,a=!1},x=r=>{const i=r.srcEvent;if(i.button!==0){g();return}if(a){let u=!1;if(r.target===o&&(console.log("drawPolyline: click on startPoint"),e.closed=!0,u=!0),r.target===t&&(console.log("drawPolyline: click on endPoint"),u=!0),u){console.log("drawPolyline: finished"),l.remove(o),l.remove(t),l.remove(n),e.styles.zIndex=c.zIndex,o=null,t=null,n=null,a=!1,e.points.length?y==null||y({type:"createPolyline",target:e,currentTarget:l}):(l.remove(e),console.log("drawPolyline: remove polyline")),e=null;return}else{console.log("drawPolyline: add-point");const d=(i.offsetX-l.translate.x)/l.scale,s=(i.offsetY-l.translate.y)/l.scale;e.points.push({x:d-e.x,y:s-e.y}),t.x=d,t.y=s}}else{if(r.target!==r.currentTarget)return;console.log("drawPolyline: click(init)"),a=!0;const u=(i.offsetX-l.translate.x)/l.scale,d=(i.offsetY-l.translate.y)/l.scale,s=u,f=d;e=new P,e.x=s,e.y=f,e.points.push({x:0,y:0}),Object.assign(e.styles,c),n=new v,n.styles.fillStyle="blue",n.styles.fillOpacity=.1,l.add(n),n.styles.zIndex=1e3,e.styles.zIndex=1001,l.add(e),o=new w(s,f,5),Object.assign(o.styles,p),o.fixedRadius=!0,o.styles.zIndex=1002,l.add(o),t=new w(s,f,5),Object.assign(t.styles,p),t.fixedRadius=!0,t.styles.zIndex=1003,l.add(t)}};l.addEventListener("pointerup",x);const m=r=>{r.key==="Escape"&&a&&g()};return document.addEventListener("keydown",m),function(){l.removeEventListener("pointerup",x),document.removeEventListener("keydown",m)}}export{h as d};
