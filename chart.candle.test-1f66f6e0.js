import{_ as v,j as I}from"./index-cf5c1735.js";import{S as k,s as T,r as b}from"./Test.module-3cb5013e.js";import{C as W,a as Y,c as R,b as V,d as A,l as H}from"./plots-41bb909b.js";function X(){const u=v.useRef(null),i=800,l=700;return v.useEffect(()=>{const g=u.current,n=new k(g),e=new W;e.viewportX=50,e.viewportY=50,e.viewportWidth=i-100,e.viewportHeight=l-100;const E=new Y(e,{followOrigin:!1});return n.add(e.indicator),n.add(E),fetch("./test-stock-data.csv").then(d=>d.text()).then(d=>{const f=d.trim().split(`
`),y=f[0].split(","),o=f.slice(1).map((t,a)=>{const F=t.split(","),h={};for(let c=0;c<y.length;c++)h[y[c]]=F[c],h.index=a;return h});o.forEach(t=>{t.timestamp=new Date().setTime(Date.parse(t.Datetime))});const p=o.map(t=>t.index).reduce((t,a)=>Math.min(t,a),1/0),x=o.map(t=>t.index).reduce((t,a)=>Math.max(t,a),-1/0);console.log("minIndex, maxIndex",p,x),e.xStart=p,e.xEnd=x,R(n,e,{lockY:!0,lockScale:!1,xStartMin:p,xEndMax:x});const P=o.map(t=>parseInt(t.Volume)).reduce((t,a)=>Math.max(t,a),-1/0),C=t=>t/P*100;e.yStart=0,e.yEnd=300,e.dispatchEvent({type:"update"});const M=o.map(t=>({x:t.index,y:C(parseInt(t.Volume))})),S=V(e,M,{barWidth:.9,color:b(.9)});n.add(S);const r=o.map(t=>({x:t.index,y:parseFloat(t["Adj Close"])})),m=r.map(t=>t.y).reduce((t,a)=>Math.min(t,a),1/0),w=r.map(t=>t.y).reduce((t,a)=>Math.max(t,a),-1/0);console.log("minPrice, maxPrice",m,w);const s=t=>(t-m)/(w-m)*100+100,j=o.map(t=>({x:t.index,open:s(parseFloat(t.Open)),close:s(parseFloat(t.Close)),high:s(parseFloat(t.High)),low:s(parseFloat(t.Low))})),D=A(e,j,{barWidth:.8});n.add(D),r.forEach(t=>{t.y=s(t.y)+50});const _=H(e,r,{color:b(.9),lineWidth:1});n.add(_)}),()=>{n.dispose()}},[]),I.jsx("div",{className:T.wrapper,children:I.jsx("canvas",{ref:u,width:i,height:l,style:{width:i,height:l,border:"rgb(255, 255, 255) 3px solid",boxShadow:"#00000076 0 0 10px 1px"}})})}export{X as default};
