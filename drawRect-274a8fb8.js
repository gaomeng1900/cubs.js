import{C as u,d as r,f as p,R}from"./Test.module-e0e1f2ce.js";import{f as j}from"./misc-3d267c02.js";function P(t,x,d,g=10,h={},y={},o={}){const w=Object.freeze({type:"rectEdit",target:t,currentTarget:t}),l=()=>{const n={type:"beforeRectEdit",target:t,currentTarget:t};j(t),x==null||x(n),d==null||d(w)},i=new u(t.x,t.y,g);i.fixedRadius=!0,Object.assign(i.styles,h),Object.assign(i.hoverStyles,y),Object.assign(i.activeStyles,o),r(i,n=>{t.width+=t.x-n.x,t.height+=t.y-n.y,t.x=n.x,t.y=n.y},l);const a=new u(t.x+t.width,t.y,g);a.fixedRadius=!0,a.styles.zIndex=t.styles.zIndex,Object.assign(a.styles,h),Object.assign(a.hoverStyles,y),Object.assign(a.activeStyles,o),r(a,n=>{t.width=n.x-t.x,t.height+=t.y-n.y,t.y=n.y},l);const e=new u(t.x,t.y+t.height,g);e.fixedRadius=!0,e.styles.zIndex=t.styles.zIndex,Object.assign(e.styles,h),Object.assign(e.hoverStyles,y),Object.assign(e.activeStyles,o),r(e,n=>{t.width+=t.x-n.x,t.height=n.y-t.y,t.x=n.x},l);const s=new u(t.x+t.width,t.y+t.height,g);return s.fixedRadius=!0,s.styles.zIndex=t.styles.zIndex,Object.assign(s.styles,h),Object.assign(s.hoverStyles,y),Object.assign(s.activeStyles,o),r(s,n=>{t.width=n.x-t.x,t.height=n.y-t.y},l),r(t,void 0,l),t.addEventListener("beforeDraw",n=>{i.x=t.x,i.y=t.y,a.x=t.x+t.width,a.y=t.y,e.x=t.x,e.y=t.y+t.height,s.x=t.x+t.width,s.y=t.y+t.height}),new p([i,a,e,s])}function I(t,x,d={}){const g=h=>{const y=h.srcEvent;if(h.target!==h.currentTarget||y.button!==0)return;const{left:o,top:w}=t.canvas.getBoundingClientRect()||{left:0,top:0},l=(y.clientX-o-t.translate.x)/t.scale,i=(y.clientY-w-t.translate.y)/t.scale,a=l,e=i,s=new R(0,0,0,0);s.x=a,s.y=e,s.width=0,s.height=0,Object.assign(s.styles,d),t.add(s);const n=b=>{const f=b.srcEvent,O=(f.clientX-o-t.translate.x)/t.scale,m=(f.clientY-w-t.translate.y)/t.scale;s.width=O-a,s.height=m-e},v=b=>{if(t.removeEventListener("pointermove",n),t.removeEventListener("pointerup",v),j(s),s.width===0||s.height===0){t.remove(s);return}x==null||x({type:"rectCreation",target:s,currentTarget:t})};t.addEventListener("pointermove",n),t.addEventListener("pointerup",v)};return t.addEventListener("pointerdown",g),function(){t.removeEventListener("pointerdown",g)}}export{I as d,P as e};
